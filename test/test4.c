#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <sdns.h>
#include <sdns_print.h>
#include <sdns_json.h>
#include <time.h>
#include <assert.h>
/*
 * Compile: cd .. && make with-json && cd test && gcc -o test test4.c -I../include -L../bin -lsdns -ljansson && ./test
 * the packet generated by the **response** of the 'dig txt @1.1.1.1 +nocookie microsoft.com +nsid'
 * here is the wireshark output:  (it has some large txt records and lots of them)
 * Domain Name System (response)
 *   Length: 1674
 *   Transaction ID: 0xf13f
 *   Flags: 0x8180 Standard query response, No error
 *       1... .... .... .... = Response: Message is a response
 *       .000 0... .... .... = Opcode: Standard query (0)
 *       .... .0.. .... .... = Authoritative: Server is not an authority for domain
 *       .... ..0. .... .... = Truncated: Message is not truncated
 *       .... ...1 .... .... = Recursion desired: Do query recursively
 *       .... .... 1... .... = Recursion available: Server can do recursive queries
 *       .... .... .0.. .... = Z: reserved (0)
 *       .... .... ..0. .... = Answer authenticated: Answer/authority portion was not authenticated by the server
 *       .... .... ...0 .... = Non-authenticated data: Unacceptable
 *       .... .... .... 0000 = Reply code: No error (0)
 *   Questions: 1
 *   Answer RRs: 22
 *   Authority RRs: 0
 *   Additional RRs: 1
 *   Queries
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           [Name Length: 13]
 *           [Label Count: 2]
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *   Answers
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 37
 *           TXT Length: 36
 *           TXT: d365mktkey=3uc1cf82cpv750lzk70v9bvf2
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 60
 *           TXT Length: 59
 *           TXT: facebook-domain-verification=fwzwhbbzwmg5fzgotc2go51olc3566
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 69
 *           TXT Length: 68
 *           TXT: google-site-verification=pjPOauSPcrfXOZS9jnPPa5axowcHGCDAl1_86dCqFpk
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 27
 *           TXT Length: 26
 *           TXT: fg2t0gov9424p2tdcuo94goe9j
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 27
 *           TXT Length: 26
 *           TXT: t7sebee51jrj7vm932k531hipa
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 69
 *           TXT Length: 68
 *           TXT: google-site-verification=M--CVfn_YwsV-2FGbCp_HFaEj23BmT0cTF4l8hXgpvM
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 69
 *           TXT Length: 68
 *           TXT: google-site-verification=GfDnTUdATPsK1230J0mXbfsYw-3A9BVMVaKSd4DcKgI
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 56
 *           TXT Length: 55
 *           TXT: d365mktkey=SxDf1EZxLvMwx6eEZUxzjFFgHoapF8DvtWEUjwq7ZTwx
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 80
 *           TXT Length: 79
 *           TXT: hubspot-developer-verification=OTQ5NGIwYWEtODNmZi00YWE1LTkyNmQtNDhjMDMxY2JjNDAx
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 56
 *           TXT Length: 55
 *           TXT: d365mktkey=QDa792dLCZhvaAOOCe2Hz6WTzmTssOp1snABhxWibhMx
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 37
 *           TXT Length: 36
 *           TXT: d365mktkey=6358r1b7e13hox60tl1uagv14
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 69
 *           TXT Length: 68
 *           TXT: google-site-verification=uFg3wr5PWsK8lV029RoXXBBUW0_E6qf1WEWVHhetkOY
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 46
 *           TXT Length: 45
 *           TXT: docusign=d5a3737c-c23c-4bd0-9095-d2ff621f2840
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 56
 *           TXT Length: 55
 *           TXT: d365mktkey=j2qHWq9BHdaa3ZXZH8x64daJZxEWsFa0dxDeilxDoYYx
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 185
 *           TXT Length: 184
 *           TXT: v=spf1 include:_spf-a.microsoft.com include:_spf-b.microsoft.com include:_spf-c.microsoft.com include:_spf-ssg-a.msft.net include:spf-a.hotmail.com include:_spf1-meo.microsoft.com -all
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 95
 *           TXT Length: 94
 *           TXT: atlassian-domain-verification=xvoaqRfxSg3PnlVnR4xCSOlKyw1Aln0MMxRiKXnwWroFG7vI76TUC8xYb03MwMXv
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 61
 *           TXT Length: 60
 *           TXT: workplace-domain-verification=lK0QDLk73xymCYMKUXNpfKAT8TY5Mx
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 69
 *           TXT Length: 68
 *           TXT: google-site-verification=uhh5_jbxpcQgnb-A7gDIjlrr5Ef34lA2t2_BAveYpnk
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 14
 *           TXT Length: 13
 *           TXT: MS=ms79629062
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 60
 *           TXT Length: 59
 *           TXT: ms-domain-verification=9feeb5bd-0f21-44bd-aa3d-ad0b1085c629
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 56
 *           TXT Length: 55
 *           TXT: d365mktkey=3l6dste9txazu0Qd2zu4135PUB4E35txLxyzJxjkPbsx
 *       microsoft.com: type TXT, class IN
 *           Name: microsoft.com
 *           Type: TXT (16) (Text strings)
 *           Class: IN (0x0001)
 *           Time to live: 1753 (29 minutes, 13 seconds)
 *           Data length: 60
 *           TXT Length: 59
 *           TXT: ms-domain-verification=b7655e93-f920-4428-bed9-de5900241a46
 *   Additional records
 *       <Root>: type OPT
 *           Name: <Root>
 *           Type: OPT (41) 
 *           UDP payload size: 1232
 *           Higher bits in extended RCODE: 0x00
 *           EDNS0 version: 0
 *           Z: 0x0000
 *               0... .... .... .... = DO bit: Cannot handle DNSSEC security RRs
 *               .000 0000 0000 0000 = Reserved: 0x0000
 *           Data length: 10
 *           Option: NSID - Name Server Identifier
 *               Option Code: NSID - Name Server Identifier (3)
 *               Option Length: 6
 *               Option Data: 34396d313532
 *   [Request In: 177]
 *   [Time: 0.023723700 seconds]
 *
 */


int main(int argc, char ** argv){
    srand(time(NULL));
    sdns_context * dns_ctx = sdns_init_context();
    if (NULL == dns_ctx){
        fprintf(stderr, "Can not initialize the DNS context...\n");
        return 1;
    }
    char packet_bytes[] = {
      0xf1, 0x3f, 0x81, 0x80, 0x00, 0x01,       // this was TCP response so I removed the first 2 bytes
      0x00, 0x16, 0x00, 0x00, 0x00, 0x01, 0x09, 0x6d,
      0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74,
      0x03, 0x63, 0x6f, 0x6d, 0x00, 0x00, 0x10, 0x00,
      0x01, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
      0x00, 0x06, 0xd9, 0x00, 0x25, 0x24, 0x64, 0x33,
      0x36, 0x35, 0x6d, 0x6b, 0x74, 0x6b, 0x65, 0x79,
      0x3d, 0x33, 0x75, 0x63, 0x31, 0x63, 0x66, 0x38,
      0x32, 0x63, 0x70, 0x76, 0x37, 0x35, 0x30, 0x6c,
      0x7a, 0x6b, 0x37, 0x30, 0x76, 0x39, 0x62, 0x76,
      0x66, 0x32, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01,
      0x00, 0x00, 0x06, 0xd9, 0x00, 0x3c, 0x3b, 0x66,
      0x61, 0x63, 0x65, 0x62, 0x6f, 0x6f, 0x6b, 0x2d,
      0x64, 0x6f, 0x6d, 0x61, 0x69, 0x6e, 0x2d, 0x76,
      0x65, 0x72, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74,
      0x69, 0x6f, 0x6e, 0x3d, 0x66, 0x77, 0x7a, 0x77,
      0x68, 0x62, 0x62, 0x7a, 0x77, 0x6d, 0x67, 0x35,
      0x66, 0x7a, 0x67, 0x6f, 0x74, 0x63, 0x32, 0x67,
      0x6f, 0x35, 0x31, 0x6f, 0x6c, 0x63, 0x33, 0x35,
      0x36, 0x36, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01,
      0x00, 0x00, 0x06, 0xd9, 0x00, 0x45, 0x44, 0x67,
      0x6f, 0x6f, 0x67, 0x6c, 0x65, 0x2d, 0x73, 0x69,
      0x74, 0x65, 0x2d, 0x76, 0x65, 0x72, 0x69, 0x66,
      0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x3d,
      0x70, 0x6a, 0x50, 0x4f, 0x61, 0x75, 0x53, 0x50,
      0x63, 0x72, 0x66, 0x58, 0x4f, 0x5a, 0x53, 0x39,
      0x6a, 0x6e, 0x50, 0x50, 0x61, 0x35, 0x61, 0x78,
      0x6f, 0x77, 0x63, 0x48, 0x47, 0x43, 0x44, 0x41,
      0x6c, 0x31, 0x5f, 0x38, 0x36, 0x64, 0x43, 0x71,
      0x46, 0x70, 0x6b, 0xc0, 0x0c, 0x00, 0x10, 0x00,
      0x01, 0x00, 0x00, 0x06, 0xd9, 0x00, 0x1b, 0x1a,
      0x66, 0x67, 0x32, 0x74, 0x30, 0x67, 0x6f, 0x76,
      0x39, 0x34, 0x32, 0x34, 0x70, 0x32, 0x74, 0x64,
      0x63, 0x75, 0x6f, 0x39, 0x34, 0x67, 0x6f, 0x65,
      0x39, 0x6a, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01,
      0x00, 0x00, 0x06, 0xd9, 0x00, 0x1b, 0x1a, 0x74,
      0x37, 0x73, 0x65, 0x62, 0x65, 0x65, 0x35, 0x31,
      0x6a, 0x72, 0x6a, 0x37, 0x76, 0x6d, 0x39, 0x33,
      0x32, 0x6b, 0x35, 0x33, 0x31, 0x68, 0x69, 0x70,
      0x61, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
      0x00, 0x06, 0xd9, 0x00, 0x45, 0x44, 0x67, 0x6f,
      0x6f, 0x67, 0x6c, 0x65, 0x2d, 0x73, 0x69, 0x74,
      0x65, 0x2d, 0x76, 0x65, 0x72, 0x69, 0x66, 0x69,
      0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x3d, 0x4d,
      0x2d, 0x2d, 0x43, 0x56, 0x66, 0x6e, 0x5f, 0x59,
      0x77, 0x73, 0x56, 0x2d, 0x32, 0x46, 0x47, 0x62,
      0x43, 0x70, 0x5f, 0x48, 0x46, 0x61, 0x45, 0x6a,
      0x32, 0x33, 0x42, 0x6d, 0x54, 0x30, 0x63, 0x54,
      0x46, 0x34, 0x6c, 0x38, 0x68, 0x58, 0x67, 0x70,
      0x76, 0x4d, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01,
      0x00, 0x00, 0x06, 0xd9, 0x00, 0x45, 0x44, 0x67,
      0x6f, 0x6f, 0x67, 0x6c, 0x65, 0x2d, 0x73, 0x69,
      0x74, 0x65, 0x2d, 0x76, 0x65, 0x72, 0x69, 0x66,
      0x69, 0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x3d,
      0x47, 0x66, 0x44, 0x6e, 0x54, 0x55, 0x64, 0x41,
      0x54, 0x50, 0x73, 0x4b, 0x31, 0x32, 0x33, 0x30,
      0x4a, 0x30, 0x6d, 0x58, 0x62, 0x66, 0x73, 0x59,
      0x77, 0x2d, 0x33, 0x41, 0x39, 0x42, 0x56, 0x4d,
      0x56, 0x61, 0x4b, 0x53, 0x64, 0x34, 0x44, 0x63,
      0x4b, 0x67, 0x49, 0xc0, 0x0c, 0x00, 0x10, 0x00,
      0x01, 0x00, 0x00, 0x06, 0xd9, 0x00, 0x38, 0x37,
      0x64, 0x33, 0x36, 0x35, 0x6d, 0x6b, 0x74, 0x6b,
      0x65, 0x79, 0x3d, 0x53, 0x78, 0x44, 0x66, 0x31,
      0x45, 0x5a, 0x78, 0x4c, 0x76, 0x4d, 0x77, 0x78,
      0x36, 0x65, 0x45, 0x5a, 0x55, 0x78, 0x7a, 0x6a,
      0x46, 0x46, 0x67, 0x48, 0x6f, 0x61, 0x70, 0x46,
      0x38, 0x44, 0x76, 0x74, 0x57, 0x45, 0x55, 0x6a,
      0x77, 0x71, 0x37, 0x5a, 0x54, 0x77, 0x78, 0xc0,
      0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x06,
      0xd9, 0x00, 0x50, 0x4f, 0x68, 0x75, 0x62, 0x73,
      0x70, 0x6f, 0x74, 0x2d, 0x64, 0x65, 0x76, 0x65,
      0x6c, 0x6f, 0x70, 0x65, 0x72, 0x2d, 0x76, 0x65,
      0x72, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69,
      0x6f, 0x6e, 0x3d, 0x4f, 0x54, 0x51, 0x35, 0x4e,
      0x47, 0x49, 0x77, 0x59, 0x57, 0x45, 0x74, 0x4f,
      0x44, 0x4e, 0x6d, 0x5a, 0x69, 0x30, 0x30, 0x59,
      0x57, 0x45, 0x31, 0x4c, 0x54, 0x6b, 0x79, 0x4e,
      0x6d, 0x51, 0x74, 0x4e, 0x44, 0x68, 0x6a, 0x4d,
      0x44, 0x4d, 0x78, 0x59, 0x32, 0x4a, 0x6a, 0x4e,
      0x44, 0x41, 0x78, 0xc0, 0x0c, 0x00, 0x10, 0x00,
      0x01, 0x00, 0x00, 0x06, 0xd9, 0x00, 0x38, 0x37,
      0x64, 0x33, 0x36, 0x35, 0x6d, 0x6b, 0x74, 0x6b,
      0x65, 0x79, 0x3d, 0x51, 0x44, 0x61, 0x37, 0x39,
      0x32, 0x64, 0x4c, 0x43, 0x5a, 0x68, 0x76, 0x61,
      0x41, 0x4f, 0x4f, 0x43, 0x65, 0x32, 0x48, 0x7a,
      0x36, 0x57, 0x54, 0x7a, 0x6d, 0x54, 0x73, 0x73,
      0x4f, 0x70, 0x31, 0x73, 0x6e, 0x41, 0x42, 0x68,
      0x78, 0x57, 0x69, 0x62, 0x68, 0x4d, 0x78, 0xc0,
      0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x06,
      0xd9, 0x00, 0x25, 0x24, 0x64, 0x33, 0x36, 0x35,
      0x6d, 0x6b, 0x74, 0x6b, 0x65, 0x79, 0x3d, 0x36,
      0x33, 0x35, 0x38, 0x72, 0x31, 0x62, 0x37, 0x65,
      0x31, 0x33, 0x68, 0x6f, 0x78, 0x36, 0x30, 0x74,
      0x6c, 0x31, 0x75, 0x61, 0x67, 0x76, 0x31, 0x34,
      0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00,
      0x06, 0xd9, 0x00, 0x45, 0x44, 0x67, 0x6f, 0x6f,
      0x67, 0x6c, 0x65, 0x2d, 0x73, 0x69, 0x74, 0x65,
      0x2d, 0x76, 0x65, 0x72, 0x69, 0x66, 0x69, 0x63,
      0x61, 0x74, 0x69, 0x6f, 0x6e, 0x3d, 0x75, 0x46,
      0x67, 0x33, 0x77, 0x72, 0x35, 0x50, 0x57, 0x73,
      0x4b, 0x38, 0x6c, 0x56, 0x30, 0x32, 0x39, 0x52,
      0x6f, 0x58, 0x58, 0x42, 0x42, 0x55, 0x57, 0x30,
      0x5f, 0x45, 0x36, 0x71, 0x66, 0x31, 0x57, 0x45,
      0x57, 0x56, 0x48, 0x68, 0x65, 0x74, 0x6b, 0x4f,
      0x59, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
      0x00, 0x06, 0xd9, 0x00, 0x2e, 0x2d, 0x64, 0x6f,
      0x63, 0x75, 0x73, 0x69, 0x67, 0x6e, 0x3d, 0x64,
      0x35, 0x61, 0x33, 0x37, 0x33, 0x37, 0x63, 0x2d,
      0x63, 0x32, 0x33, 0x63, 0x2d, 0x34, 0x62, 0x64,
      0x30, 0x2d, 0x39, 0x30, 0x39, 0x35, 0x2d, 0x64,
      0x32, 0x66, 0x66, 0x36, 0x32, 0x31, 0x66, 0x32,
      0x38, 0x34, 0x30, 0xc0, 0x0c, 0x00, 0x10, 0x00,
      0x01, 0x00, 0x00, 0x06, 0xd9, 0x00, 0x38, 0x37,
      0x64, 0x33, 0x36, 0x35, 0x6d, 0x6b, 0x74, 0x6b,
      0x65, 0x79, 0x3d, 0x6a, 0x32, 0x71, 0x48, 0x57,
      0x71, 0x39, 0x42, 0x48, 0x64, 0x61, 0x61, 0x33,
      0x5a, 0x58, 0x5a, 0x48, 0x38, 0x78, 0x36, 0x34,
      0x64, 0x61, 0x4a, 0x5a, 0x78, 0x45, 0x57, 0x73,
      0x46, 0x61, 0x30, 0x64, 0x78, 0x44, 0x65, 0x69,
      0x6c, 0x78, 0x44, 0x6f, 0x59, 0x59, 0x78, 0xc0,
      0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x06,
      0xd9, 0x00, 0xb9, 0xb8, 0x76, 0x3d, 0x73, 0x70,
      0x66, 0x31, 0x20, 0x69, 0x6e, 0x63, 0x6c, 0x75,
      0x64, 0x65, 0x3a, 0x5f, 0x73, 0x70, 0x66, 0x2d,
      0x61, 0x2e, 0x6d, 0x69, 0x63, 0x72, 0x6f, 0x73,
      0x6f, 0x66, 0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x20,
      0x69, 0x6e, 0x63, 0x6c, 0x75, 0x64, 0x65, 0x3a,
      0x5f, 0x73, 0x70, 0x66, 0x2d, 0x62, 0x2e, 0x6d,
      0x69, 0x63, 0x72, 0x6f, 0x73, 0x6f, 0x66, 0x74,
      0x2e, 0x63, 0x6f, 0x6d, 0x20, 0x69, 0x6e, 0x63,
      0x6c, 0x75, 0x64, 0x65, 0x3a, 0x5f, 0x73, 0x70,
      0x66, 0x2d, 0x63, 0x2e, 0x6d, 0x69, 0x63, 0x72,
      0x6f, 0x73, 0x6f, 0x66, 0x74, 0x2e, 0x63, 0x6f,
      0x6d, 0x20, 0x69, 0x6e, 0x63, 0x6c, 0x75, 0x64,
      0x65, 0x3a, 0x5f, 0x73, 0x70, 0x66, 0x2d, 0x73,
      0x73, 0x67, 0x2d, 0x61, 0x2e, 0x6d, 0x73, 0x66,
      0x74, 0x2e, 0x6e, 0x65, 0x74, 0x20, 0x69, 0x6e,
      0x63, 0x6c, 0x75, 0x64, 0x65, 0x3a, 0x73, 0x70,
      0x66, 0x2d, 0x61, 0x2e, 0x68, 0x6f, 0x74, 0x6d,
      0x61, 0x69, 0x6c, 0x2e, 0x63, 0x6f, 0x6d, 0x20,
      0x69, 0x6e, 0x63, 0x6c, 0x75, 0x64, 0x65, 0x3a,
      0x5f, 0x73, 0x70, 0x66, 0x31, 0x2d, 0x6d, 0x65,
      0x6f, 0x2e, 0x6d, 0x69, 0x63, 0x72, 0x6f, 0x73,
      0x6f, 0x66, 0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x20,
      0x2d, 0x61, 0x6c, 0x6c, 0xc0, 0x0c, 0x00, 0x10,
      0x00, 0x01, 0x00, 0x00, 0x06, 0xd9, 0x00, 0x5f,
      0x5e, 0x61, 0x74, 0x6c, 0x61, 0x73, 0x73, 0x69,
      0x61, 0x6e, 0x2d, 0x64, 0x6f, 0x6d, 0x61, 0x69,
      0x6e, 0x2d, 0x76, 0x65, 0x72, 0x69, 0x66, 0x69,
      0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x3d, 0x78,
      0x76, 0x6f, 0x61, 0x71, 0x52, 0x66, 0x78, 0x53,
      0x67, 0x33, 0x50, 0x6e, 0x6c, 0x56, 0x6e, 0x52,
      0x34, 0x78, 0x43, 0x53, 0x4f, 0x6c, 0x4b, 0x79,
      0x77, 0x31, 0x41, 0x6c, 0x6e, 0x30, 0x4d, 0x4d,
      0x78, 0x52, 0x69, 0x4b, 0x58, 0x6e, 0x77, 0x57,
      0x72, 0x6f, 0x46, 0x47, 0x37, 0x76, 0x49, 0x37,
      0x36, 0x54, 0x55, 0x43, 0x38, 0x78, 0x59, 0x62,
      0x30, 0x33, 0x4d, 0x77, 0x4d, 0x58, 0x76, 0xc0,
      0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x06,
      0xd9, 0x00, 0x3d, 0x3c, 0x77, 0x6f, 0x72, 0x6b,
      0x70, 0x6c, 0x61, 0x63, 0x65, 0x2d, 0x64, 0x6f,
      0x6d, 0x61, 0x69, 0x6e, 0x2d, 0x76, 0x65, 0x72,
      0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69, 0x6f,
      0x6e, 0x3d, 0x6c, 0x4b, 0x30, 0x51, 0x44, 0x4c,
      0x6b, 0x37, 0x33, 0x78, 0x79, 0x6d, 0x43, 0x59,
      0x4d, 0x4b, 0x55, 0x58, 0x4e, 0x70, 0x66, 0x4b,
      0x41, 0x54, 0x38, 0x54, 0x59, 0x35, 0x4d, 0x78,
      0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00,
      0x06, 0xd9, 0x00, 0x45, 0x44, 0x67, 0x6f, 0x6f,
      0x67, 0x6c, 0x65, 0x2d, 0x73, 0x69, 0x74, 0x65,
      0x2d, 0x76, 0x65, 0x72, 0x69, 0x66, 0x69, 0x63,
      0x61, 0x74, 0x69, 0x6f, 0x6e, 0x3d, 0x75, 0x68,
      0x68, 0x35, 0x5f, 0x6a, 0x62, 0x78, 0x70, 0x63,
      0x51, 0x67, 0x6e, 0x62, 0x2d, 0x41, 0x37, 0x67,
      0x44, 0x49, 0x6a, 0x6c, 0x72, 0x72, 0x35, 0x45,
      0x66, 0x33, 0x34, 0x6c, 0x41, 0x32, 0x74, 0x32,
      0x5f, 0x42, 0x41, 0x76, 0x65, 0x59, 0x70, 0x6e,
      0x6b, 0xc0, 0x0c, 0x00, 0x10, 0x00, 0x01, 0x00,
      0x00, 0x06, 0xd9, 0x00, 0x0e, 0x0d, 0x4d, 0x53,
      0x3d, 0x6d, 0x73, 0x37, 0x39, 0x36, 0x32, 0x39,
      0x30, 0x36, 0x32, 0xc0, 0x0c, 0x00, 0x10, 0x00,
      0x01, 0x00, 0x00, 0x06, 0xd9, 0x00, 0x3c, 0x3b,
      0x6d, 0x73, 0x2d, 0x64, 0x6f, 0x6d, 0x61, 0x69,
      0x6e, 0x2d, 0x76, 0x65, 0x72, 0x69, 0x66, 0x69,
      0x63, 0x61, 0x74, 0x69, 0x6f, 0x6e, 0x3d, 0x39,
      0x66, 0x65, 0x65, 0x62, 0x35, 0x62, 0x64, 0x2d,
      0x30, 0x66, 0x32, 0x31, 0x2d, 0x34, 0x34, 0x62,
      0x64, 0x2d, 0x61, 0x61, 0x33, 0x64, 0x2d, 0x61,
      0x64, 0x30, 0x62, 0x31, 0x30, 0x38, 0x35, 0x63,
      0x36, 0x32, 0x39, 0xc0, 0x0c, 0x00, 0x10, 0x00,
      0x01, 0x00, 0x00, 0x06, 0xd9, 0x00, 0x38, 0x37,
      0x64, 0x33, 0x36, 0x35, 0x6d, 0x6b, 0x74, 0x6b,
      0x65, 0x79, 0x3d, 0x33, 0x6c, 0x36, 0x64, 0x73,
      0x74, 0x65, 0x39, 0x74, 0x78, 0x61, 0x7a, 0x75,
      0x30, 0x51, 0x64, 0x32, 0x7a, 0x75, 0x34, 0x31,
      0x33, 0x35, 0x50, 0x55, 0x42, 0x34, 0x45, 0x33,
      0x35, 0x74, 0x78, 0x4c, 0x78, 0x79, 0x7a, 0x4a,
      0x78, 0x6a, 0x6b, 0x50, 0x62, 0x73, 0x78, 0xc0,
      0x0c, 0x00, 0x10, 0x00, 0x01, 0x00, 0x00, 0x06,
      0xd9, 0x00, 0x3c, 0x3b, 0x6d, 0x73, 0x2d, 0x64,
      0x6f, 0x6d, 0x61, 0x69, 0x6e, 0x2d, 0x76, 0x65,
      0x72, 0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x69,
      0x6f, 0x6e, 0x3d, 0x62, 0x37, 0x36, 0x35, 0x35,
      0x65, 0x39, 0x33, 0x2d, 0x66, 0x39, 0x32, 0x30,
      0x2d, 0x34, 0x34, 0x32, 0x38, 0x2d, 0x62, 0x65,
      0x64, 0x39, 0x2d, 0x64, 0x65, 0x35, 0x39, 0x30,
      0x30, 0x32, 0x34, 0x31, 0x61, 0x34, 0x36, 0x00,
      0x00, 0x29, 0x04, 0xd0, 0x00, 0x00, 0x00, 0x00,
      0x00, 0x0a, 0x00, 0x03, 0x00, 0x06, 0x34, 0x39,
      0x6d, 0x31, 0x35, 0x32
    };
    dns_ctx->raw = packet_bytes;
    dns_ctx->raw_len = sizeof(packet_bytes);
    int res = sdns_from_wire(dns_ctx);
    assert(res == 0);
    char *dmp = sdns_json_dns_string(dns_ctx);
    fprintf(stdout, "%s\n", dmp);
    free(dmp);
    dns_ctx->raw = NULL;
    sdns_free_context(dns_ctx);
    return 0;
}
